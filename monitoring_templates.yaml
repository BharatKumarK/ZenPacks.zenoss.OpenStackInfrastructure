# Ceilometer Reference: http://docs.openstack.org/developer/ceilometer/measurements.html

/OpenStack/Infrastructure/Instance:
  description: "OpenStackInfrastructure: Instance Monitoring"
  targetPythonClass: ZenPacks.zenoss.OpenStackInfrastructure.Instance

  datasources:
    cpuUtilization:
      type: OpenStack Ceilometer Perf AMQP
      meter: 'cpu_util'
      severity: 'Clear'

      datapoints:
        cpuUtilization:
          rrdmin: 0
          aliases:
            cpu__pct: ""

    diskReadRequestsRate:
      type: OpenStack Ceilometer Perf AMQP
      meter: 'disk.read.requests.rate'
      severity: 'Clear'

      datapoints:
        diskReadRequestsRate:
          rrdmin: 0
          aliases:
            disk_reads__persec: ""

    diskWriteRequestsRate:
      type: OpenStack Ceilometer Perf AMQP
      meter: 'disk.write.requests.rate'
      severity: 'Clear'

      datapoints:
        diskWriteRequestsRate:
          rrdmin: 0
          aliases:
            disk_writes__persec: ""

    diskReadBytesRate:
      type: OpenStack Ceilometer Perf AMQP
      meter: 'disk.read.bytes.rate'
      severity: 'Clear'

      datapoints:
        diskReadBytesRate:
          rrdmin: 0
          aliases:
            disk_read__bytessec: ""

    diskWriteBytesRate:
      type: OpenStack Ceilometer Perf AMQP
      meter: 'disk.write.bytes.rate'
      severity: 'Clear'

      datapoints:
        diskWriteBytesRate:
          rrdmin: 0
          aliases:
            disk_write__bytessec: ""

  graphs:
    CPU Utilization:
      units: percent
      miny: 0
      maxy: 100

      graphpoints:
        CPU Utilization:
          dpName: cpuUtilization
          format: "%5.2lf"

    Disk Requests:
      units: requests/sec
      miny: 0

      graphpoints:
        Read:
          dpName: diskReadRequestsRate
          format: "%5.2lf"

        Write:
          dpName: diskWriteRequestsRate
          format: "%5.2lf"

    Disk IO Rate:
      units: bytes/sec
      miny: 0

      graphpoints:
        Read:
          dpName: diskReadBytesRate
          format: "%5.2lf"

        Write:
          dpName: diskWriteBytesRate
          format: "%5.2lf"


/OpenStack/Infrastructure/Vnic:
  description: "OpenStackInfrastructure: Vnic Monitoring"
  targetPythonClass: ZenPacks.zenoss.OpenStackInfrastructure.Vnic

  datasources:
    networkIncomingPacketsRate:
      type: OpenStack Ceilometer Perf AMQP
      meter: 'network.incoming.packets.rate'
      severity: 'Clear'

      datapoints:
        networkIncomingPacketsRate:
          rrdmin: 0
          aliases:
            if_received_packets__persec: ""


    networkOutgoingPacketsRate:
      type: OpenStack Ceilometer Perf AMQP
      meter: 'network.outgoing.packets.rate'
      severity: 'Clear'

      datapoints:
        networkOutgoingPacketsRate:
          rrdmin: 0
          aliases:
            if_sent_packets__persec: ""

    networkIncomingBytesRate:
      type: OpenStack Ceilometer Perf AMQP
      meter: 'network.incoming.bytes.rate'
      severity: 'Clear'

      datapoints:
        networkIncomingBytesRate:
          rrdmin: 0
          aliases:
            if_received__bytessec: ""

    networkOutgoingBytesRate:
      type: OpenStack Ceilometer Perf AMQP
      meter: 'network.outgoing.bytes.rate'
      severity: 'Clear'

      datapoints:
        networkOutgoingBytesRate:
          rrdmin: 0
          aliases:
            if_sent__bytessec: ""

  graphs:
    Network Packet Rate:
      units: packets/sec
      miny: 0

      graphpoints:
        Inbound:
          dpName: networkIncomingPacketsRate
          format: "%5.2lf"

        Outbound:
          dpName: networkOutgoingPacketsRate
          format: "%5.2lf"

    Network Throughput:
      units: bytes/sec
      miny: 0

      graphpoints:
        Inbound:
          dpName: networkIncomingBytesRate
          format: "%5.2lf"

        Outbound:
          dpName: networkOutgoingBytesRate
          format: "%5.2lf"

/OpenStack/Infrastructure/Endpoint:
  description: "OpenStackInfrastructure: Endpoint Monitoring"
  targetPythonClass: ZenPacks.zenoss.OpenStackInfrastructure.Endpoint

  datasources:
    events:
      type: OpenStack Ceilometer Events AMQP

    heartbearts:
      type: OpenStack Ceilometer Heartbeats AMQP

    serviceStatus:
      type: OpenStack Nova Service Status

    neutronAgentStatus:
      type: OpenStack Neutron Agent Status

    openstackQueues:
      commandTemplate: ${here/ZenPackManager/packs/ZenPacks.zenoss.OpenStackInfrastructure/path}/queue_counts.py '${here/id}'
      cycletime: 300
      datapoints:
        eventQueueCount:
          rrdmin: 0
        perfQueueCount:
          rrdmin: 0
      parser: ZenPacks.zenoss.OpenStackInfrastructure.parsers.OpenStackQueue
      type: COMMAND
      usessh: false

    openstack:
      commandTemplate: ${here/ZenPackManager/packs/ZenPacks.zenoss.OpenStackInfrastructure/path}/poll_openstack.py '${here/zCommandUsername}' '${here/zCommandPassword}' '${here/zOpenStackProjectId}' '${here/zOpenStackAuthUrl}' '${here/zOpenStackRegionName}'
      cycletime: 300
      datapoints:
        flavorTotalCount:
          rrdmin: 0
          aliases:
            flavor_total__count: ""
        imageActiveCount:
          rrdmin: 0
          aliases:
            image_active__count: ""
        imageFailedCount:
          rrdmin: 0
          aliases:
            image_failed__count: ""
        imageOtherCount:
          rrdmin: 0
          aliases:
            image_other__count: ""
        imagePreparingCount:
          rrdmin: 0
          aliases:
            image_preparing__count: ""
        imageQueuedCount:
          rrdmin: 0
          aliases:
            image_queued__count: ""
        imageSavingCount:
          rrdmin: 0
          aliases:
            image_saving__count: ""
        imageTotalCount:
          rrdmin: 0
          aliases:
            image_total__count: ""
        imageUnknownCount:
          rrdmin: 0
          aliases:
            image_unknown__count: ""
        serverActiveCount:
          rrdmin: 0
          aliases:
            server_active__count: ""
        serverBuildCount:
          rrdmin: 0
          aliases:
            server_build__count: ""
        serverDeleteIpCount:
          rrdmin: 0
          aliases:
            server_delete__count: ""
        serverHardRebootCount:
          rrdmin: 0
          aliases:
            server_hard_reboot__count: ""
        serverOtherCount:
          rrdmin: 0
          aliases:
            server_other__count: ""
        serverPasswordCount:
          rrdmin: 0
          aliases:
            server_password__count: ""
        serverPrepResizeCount:
          rrdmin: 0
          aliases:
            server_prep_resize__count: ""
        serverQueueResizeCount:
          rrdmin: 0
          aliases:
            server_queue_resize__count: ""
        serverRebootCount:
          rrdmin: 0
          aliases:
            server_reboot__count: ""
        serverRebuildCount:
          rrdmin: 0
          aliases:
            server_rebuild__count: ""
        serverRescueCount:
          rrdmin: 0
          aliases:
            server_rescue__count: ""
        serverResizeCount:
          rrdmin: 0
          aliases:
            server_resize__count: ""
        serverSuspendedCount:
          rrdmin: 0
          aliases:
            server_suspended__count: ""
        serverTotalCount:
          rrdmin: 0
          aliases:
            server_total__count: ""
        serverUnknownCount:
          rrdmin: 0
          aliases:
            server_unknown__count: ""
        serverVerifyResizeCount:
          rrdmin: 0
          aliases:
            server_verify_resize__count: ""

        agentTotalCount:
          rrdmin: 0
          aliases:
            agent_total__count: ""
        agentDHCPCount:
          rrdmin: 0
          aliases:
            agent_dhcp__count: ""
        agentOVSCount:
          rrdmin: 0
          aliases:
            agent_ovs__count: ""
        agentLinuxBridgeCount:
          rrdmin: 0
          aliases:
            agent_linux_bridge__count: ""
        agentHyperVCount:
          rrdmin: 0
          aliases:
            agent_hyperv__count: ""
        agentNECCount:
          rrdmin: 0
          aliases:
            agent_nec__count: ""
        agentOFACount:
          rrdmin: 0
          aliases:
            agent_ofa__count: ""
        agentL3Count:
          rrdmin: 0
          aliases:
            agent_l3__count: ""
        agentLBCount:
          rrdmin: 0
          aliases:
            agent_lb__count: ""
        agentMLNXCount:
          rrdmin: 0
          aliases:
            agent_mlnx__count: ""
        agentMeteringCount:
          rrdmin: 0
          aliases:
            agent_metering__count: ""
        agentMetadataCount:
          rrdmin: 0
          aliases:
            agent_metadata__count: ""
        agentSDNVECount:
          rrdmin: 0
          aliases:
            agent_sdnve__count: ""
        agentNICSCount:
          rrdmin: 0
          aliases:
            agent_nics__count: ""
        agentAliveCount:
          rrdmin: 0
          aliases:
            agent_alive__count: ""
        agentDeadCount:
          rrdmin: 0
          aliases:
            agent_dead__count: ""

        networkTotalCount:
          rrdmin: 0
          aliases:
            network_total__count: ""
        networkActiveCount:
          rrdmin: 0
          aliases:
            network_avtive__count: ""
        networkBuildCount:
          rrdmin: 0
          aliases:
            network_build__count: ""
        networkDownCount:
          rrdmin: 0
          aliases:
            network_down__count: ""
        networkErrorCount:
          rrdmin: 0
          aliases:
            network_error__count: ""
        networkSharedCount:
          rrdmin: 0
          aliases:
            network_shared__count: ""
        networkExternalCount:
          rrdmin: 0
          aliases:
            network_external__count: ""
        networkInternalCount:
          rrdmin: 0
          aliases:
            network_internal__count: ""

        routerTotalCount:
          rrdmin: 0
          aliases:
            router_total__count: ""
        routerActiveCount:
          rrdmin: 0
          aliases:
            router_active__count: ""
        routerBuildCount:
          rrdmin: 0
          aliases:
            router_build__count: ""
        routerDownCount:
          rrdmin: 0
          aliases:
            router_down__count: ""
        routerErrorCount:
          rrdmin: 0
          aliases:
            router_error__count: ""

      parser: ZenPacks.zenoss.OpenStackInfrastructure.parsers.endpoint
      type: COMMAND
      usessh: false

  graphs:
    Flavors:
      units: count
      height: 100
      width: 500

      graphpoints:
        Total:
          dpName: openstack_flavorTotalCount
          format: '%7.0lf'
    Images:
      units: count
      height: 100
      width: 500

      graphpoints:
        Active:
          dpName: openstack_imageActiveCount
          format: '%7.0lf'
        Failed:
          dpName: openstack_imageFailedCount
          format: '%7.0lf'
        Other:
          dpName: openstack_imageOtherCount
          format: '%7.0lf'
        Preparing:
          dpName: openstack_imagePreparingCount
          format: '%7.0lf'
        Queued:
          dpName: openstack_imageQueuedCount
          format: '%7.0lf'
        Saving:
          dpName: openstack_imageSavingCount
          format: '%7.0lf'
        Total:
          dpName: openstack_imageTotalCount
          format: '%7.0lf'
        Unknown:
          dpName: openstack_imageUnknownCount
          format: '%7.0lf'

    Servers:
      units: count
      height: 100
      width: 500

      graphpoints:
        Active:
          dpName: openstack_serverActiveCount
          format: '%7.0lf'
        Build:
          dpName: openstack_serverBuildCount
          format: '%7.0lf'
        Delete IP:
          dpName: openstack_serverDeleteIpCount
          format: '%7.0lf'
        Hard Reboot:
          dpName: openstack_serverHardRebootCount
          format: '%7.0lf'
        Other:
          dpName: openstack_serverOtherCount
          format: '%7.0lf'
        Password:
          dpName: openstack_serverPasswordCount
          format: '%7.0lf'
        Prep Resize:
          dpName: openstack_serverPrepResizeCount
          format: '%7.0lf'
        Queue Resize:
          dpName: openstack_serverQueueResizeCount
          format: '%7.0lf'
        Reboot:
          dpName: openstack_serverRebootCount
          format: '%7.0lf'
        Rebuild:
          dpName: openstack_serverRebuildCount
          format: '%7.0lf'
        Rescue:
          dpName: openstack_serverRescueCount
          format: '%7.0lf'
        Resize:
          dpName: openstack_serverResizeCount
          format: '%7.0lf'
        Suspended:
          dpName: openstack_serverSuspendedCount
          format: '%7.0lf'
        Total:
          dpName: openstack_serverTotalCount
          format: '%7.0lf'
        Unknown:
          dpName: openstack_serverUnknownCount
          format: '%7.0lf'
        Verify Resize:
          dpName: openstack_serverVerifyResizeCount
          format: '%7.0lf'

    Queues:
      units: count
      height: 100
      width: 500

      graphpoints:
        Event:
          dpName: openstackQueues_eventQueueCount
          format: '%7.0lf'
        performance:
          dpName: openstackQueues_perfQueueCount
          format: '%7.0lf'

    Agents:
      units: count
      height: 100
      width: 500

      graphpoints:
        Total:
          dpName: openstack_agentTotalCount
          format: '%7.0lf'
        Active:
          dpName: openstack_agentActiveCount
          format: '%7.0lf'
        Alive:
          dpName: openstack_agentAliveCount
          format: '%7.0lf'
        Dead:
          dpName: openstack_agentDeadCount
          format: '%7.0lf'
        DHCP:
          dpName: openstack_agentDHCPCount
          format: '%7.0lf'
        Open vSwitch:
          dpName: openstack_agentOVSCount
          format: '%7.0lf'
        Linux Bridge:
          dpName: openstack_agentLinuxBridgeCount
          format: '%7.0lf'
        HyperV:
          dpName: openstack_agentHyperVCount
          format: '%7.0lf'
        NEC OpenFlow:
          dpName: openstack_agentNECCount
          format: '%7.0lf'
        OpenFlow Agent:
          dpName: openstack_agentOFACount
          format: '%7.0lf'
        Level 3:
          dpName: openstack_agentL3Count
          format: '%7.0lf'
        Load Balancer:
          dpName: openstack_agentLBCount
          format: '%7.0lf'
        Mellanox:
          dpName: openstack_agentMLNXVCount
          format: '%7.0lf'
        Metering:
          dpName: openstack_agentMeteringVCount
          format: '%7.0lf'
        Metadata:
          dpName: openstack_agentMetadataCount
          format: '%7.0lf'
        IBM SDN-VE:
          dpName: openstack_agentSDNVECount
          format: '%7.0lf'
        SR-IOV NIC:
          dpName: openstack_agentNICSCount
          format: '%7.0lf'

    Networks:
      units: count
      height: 100
      width: 500

      graphpoints:
        Total:
          dpName: openstack_networkTotalCount
          format: '%7.0lf'
        Active:
          dpName: openstack_networkActiveCount
          format: '%7.0lf'
        Build:
          dpName: openstack_networkBuildCount
          format: '%7.0lf'
        Down:
          dpName: openstack_networkDownCount
          format: '%7.0lf'
        Error:
          dpName: openstack_networkErrorCount
          format: '%7.0lf'
        Shared:
          dpName: openstack_networkSharedCount
          format: '%7.0lf'
        External:
          dpName: openstack_networkExternalCount
          format: '%7.0lf'
        Internal:
          dpName: openstack_networkInternalCount
          format: '%7.0lf'

    Routers:
      units: count
      height: 100
      width: 500

      graphpoints:
        Total:
          dpName: openstack_routerTotalCount
          format: '%7.0lf'
        Active:
          dpName: openstack_routerActiveCount
          format: '%7.0lf'
        Build:
          dpName: openstack_routerBuildCount
          format: '%7.0lf'
        Down:
          dpName: openstack_routerDownCount
          format: '%7.0lf'
        Error:
          dpName: openstack_routerErrorCount
          format: '%7.0lf'
